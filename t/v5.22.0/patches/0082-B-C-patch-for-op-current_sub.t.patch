From e0d8452d9e801969be2dd3de3d5b9e304449dc2f Mon Sep 17 00:00:00 2001
From: Nicolas Rochelemagne <rochelemagne@cpanel.net>
Date: Tue, 29 Sep 2015 14:35:46 -0500
Subject: [PATCH 082/211] B::C patch for op/current_sub.t

---
 t/op/current_sub.t | 17 +++++------------
 1 file changed, 5 insertions(+), 12 deletions(-)

diff --git a/t/op/current_sub.t b/t/op/current_sub.t
index 2dcc184..bbc90ca 100644
--- a/t/op/current_sub.t
+++ b/t/op/current_sub.t
@@ -1,12 +1,13 @@
 #!./perl
 
 BEGIN {
-    chdir 't' if -d 't';
-    @INC = qw(../lib);
+    chdir 't' if -d 't';    
     require './test.pl';
-    plan (tests => 22);
+    set_up_inc( qw(../lib) );    
 }
 
+plan (tests => 20);
+
 is __SUB__, "__SUB__", '__SUB__ is a bareword outside of use feature';
 
 {
@@ -37,15 +38,6 @@ is $subsubs[0]()(0), 1, '__SUB__ inside closure (1)';
 is $subsubs[1]()(0), 2, '__SUB__ inside closure (2)';
 is $subsubs[2]()(0), 3, '__SUB__ inside closure (3)';
 
-BEGIN {
-    return "begin 1" if @_;
-    is CORE::__SUB__->(0), "begin 1", 'in BEGIN block'
-}
-BEGIN {
-    return "begin 2" if @_;
-    is &CORE::__SUB__->(0), "begin 2", 'in BEGIN block via & (unoptimised)'
-}
-
 sub bar;
 sub bar {
     () = sort {
@@ -94,3 +86,4 @@ is &$f, $f, 'anonymous sub(){eval ""; __SUB__} returns self ref';
       'sub(){__SUB__} under -d';
 }
 
+note "done";
-- 
2.5.0

